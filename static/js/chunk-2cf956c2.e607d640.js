(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cf956c2"],{1859:function(e,t,a){},"9ef7":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-common-box"},[a("div",{staticClass:"title-box"},[a("Breadcrumb",{attrs:{isLevel:2}}),a("div",{staticClass:"rightbox"},[a("div",{staticClass:"item",on:{click:function(t){return e.handleOrgans()}}},[a("cc-svg-icon",{attrs:{"icon-class":"add"}}),a("span",[e._v("新增")])],1)])],1),a("div",{staticClass:"card-box"},[a("div",{staticClass:"search-bar"},[a("div",{staticClass:"search-left"},[a("div",{staticClass:"search-item"},[a("span",{staticClass:"search-label"},[e._v("机构编码")]),a("el-input",{attrs:{placeholder:"请输入机构编码",clearable:""},model:{value:e.searchKey.organizationIdLike,callback:function(t){e.$set(e.searchKey,"organizationIdLike","string"===typeof t?t.trim():t)},expression:"searchKey.organizationIdLike"}})],1),a("div",{staticClass:"search-item"},[a("span",{staticClass:"search-label"},[e._v("机构名称")]),a("el-input",{attrs:{placeholder:"请输入机构名称",clearable:""},model:{value:e.searchKey.nameLike,callback:function(t){e.$set(e.searchKey,"nameLike","string"===typeof t?t.trim():t)},expression:"searchKey.nameLike"}})],1),a("div",{staticClass:"search-item"},[a("span",{staticClass:"search-label"},[e._v("上级机构名称")]),a("el-input",{attrs:{placeholder:"请输入上级机构名称",clearable:""},model:{value:e.searchKey.parentOrganizationNameLike,callback:function(t){e.$set(e.searchKey,"parentOrganizationNameLike","string"===typeof t?t.trim():t)},expression:"searchKey.parentOrganizationNameLike"}})],1)]),a("div",{staticClass:"search-right"},[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-search"},on:{click:function(t){return e.querylist()}}},[e._v("查询")]),a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-delete"},on:{click:function(t){return e.Refreshlist()}}},[e._v("清空")])],1)]),a("div",{staticClass:"table-box"},[a("el-table",{attrs:{data:e.dataList,"tooltip-effect":"dark",stripe:"",height:"100%"}},[a("el-table-column",{attrs:{label:"序号",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.$index+(e.pageNum-1)*e.pageSize+1)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"organizationId",label:"机构编码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.organizationId?t.row.organizationId:e.EMPTYTEXT)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"name",label:"机构名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.name?t.row.name:e.EMPTYTEXT)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"parentOrganizationName",label:"上级机构名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.parentOrganizationName?t.row.parentOrganizationName:e.EMPTYTEXT)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"orgType",label:"机构类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.orgType?e.orgtypeOption[t.row.orgType]:e.EMPTYTEXT)+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"orgStatus",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(1===t.row.orgStatus?"启用":2===t.row.orgStatus?"禁用":e.EMPTYTEXT)+"\n          ")]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cc-svg-icon",{attrs:{"icon-class":"edit"},on:{click:function(a){return e.handleOrgans(t.row.sysGuid)}}}),a("cc-svg-icon",{attrs:{"icon-class":"maintain"},on:{click:function(a){return e.handleView(t.row)}}})]}}])})],1)],1),a("div",{staticClass:"page-box"},[a("Paginaction",{ref:"paginationEvent",staticClass:"pagination",attrs:{goPage:e.pageNum,totalNum:e.totalNum},on:{updateList:e.changePage}})],1)]),a("addOrgan",{attrs:{id:e.sysGuid},on:{refresh:e.getDatalist},model:{value:e.organsDialog,callback:function(t){e.organsDialog=t},expression:"organsDialog"}})],1)},n=[],i=a("5176"),o=a.n(i),s=a("a4bb"),l=a.n(s),c=(a("ac6a"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"organForm-box",attrs:{title:e.id?"修改机构":"新增机构",visible:e.show,center:"",width:"550px","close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:function(t){return e.resetForm("ruleForm")}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[e.id?a("el-form-item",{attrs:{label:"机构编码："}},[a("p",[e._v(e._s(e.ruleForm.organizationId))])]):e._e(),a("el-form-item",{attrs:{label:"机构名称：",prop:"name"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入机构名称",clearable:"",maxlength:"20"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name","string"===typeof t?t.trim():t)},expression:"ruleForm.name"}})],1),a("el-form-item",{attrs:{label:"所属区域：",prop:e.id?"":"provinceId"}},[e.id?[a("p",[e._v(e._s(e.ruleForm.villageName?e.ruleForm.provinceName+e.ruleForm.cityName+e.ruleForm.countyName+e.ruleForm.townName+e.ruleForm.villageName:e.EMPTYTEXT))])]:[a("Address",{ref:"addressEvent",attrs:{address:e.addressObj},on:{getAddress:e.getReportPlace}})]],2),a("el-form-item",{attrs:{label:"上级机构：",prop:e.id?"":"parentOrganizationId"}},[e.id?[a("p",[e._v(e._s(e.ruleForm.parentOrganizationName||e.EMPTYTEXT))])]:[a("treeselect",{staticClass:"input-box",attrs:{multiple:!1,options:e.organOption,placeholder:"请选择上级机构"},on:{select:e.selectParentOrgan,input:e.clearParentOrgan},model:{value:e.ruleForm.parentOrganizationId,callback:function(t){e.$set(e.ruleForm,"parentOrganizationId",t)},expression:"ruleForm.parentOrganizationId"}})]],2),a("el-form-item",{attrs:{label:"机构类别：",prop:e.id?"":"orgType"}},[e.id?[a("p",[e._v(e._s(e.ruleForm.orgType?e.orgtypeOption[e.ruleForm.orgType]:e.EMPTYTEXT))])]:[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择机构类别",clearable:""},model:{value:e.ruleForm.orgType,callback:function(t){e.$set(e.ruleForm,"orgType",t)},expression:"ruleForm.orgType"}},e._l(e.orgtypeOption,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:+t}})}),1)]],2),a("el-form-item",{attrs:{label:"机构地址：",prop:"addressDetail"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入机构地址",clearable:"",maxlength:"50"},model:{value:e.ruleForm.addressDetail,callback:function(t){e.$set(e.ruleForm,"addressDetail","string"===typeof t?t.trim():t)},expression:"ruleForm.addressDetail"}})],1),a("el-form-item",{attrs:{label:"联系人：",prop:"contactName"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入联系人",clearable:"",maxlength:"10"},model:{value:e.ruleForm.contactName,callback:function(t){e.$set(e.ruleForm,"contactName","string"===typeof t?t.trim():t)},expression:"ruleForm.contactName"}})],1),a("el-form-item",{attrs:{label:"联系电话：",prop:"contactPhone"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入联系电话",maxlength:"11",clearable:""},model:{value:e.ruleForm.contactPhone,callback:function(t){e.$set(e.ruleForm,"contactPhone","string"===typeof t?t.trim():t)},expression:"ruleForm.contactPhone"}})],1),a("el-form-item",{attrs:{label:"状态：",prop:"orgStatus"}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择状态"},model:{value:e.ruleForm.orgStatus,callback:function(t){e.$set(e.ruleForm,"orgStatus",t)},expression:"ruleForm.orgStatus"}},[a("el-option",{attrs:{label:"已启用",value:1}}),a("el-option",{attrs:{label:"已禁用",value:2}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确 认")])],1)],1)}),u=[],m=a("f499"),g=a.n(m),d=(a("a481"),a("c5f6"),a("af75")),p=a("7026"),h=a.n(p),f=(a("542c"),{name:"addOrgan",components:{Treeselect:h.a},props:{value:{type:Boolean},id:{type:[String,Number],value:""}},model:{prop:"value",event:"change"},watch:{value:function(e){var t=this;this.show=this.value,!0===this.show&&(this.getParentOrganList(),this.id?this.getOrganDetail():(this.initForm(),this.$nextTick(function(){t.$refs["ruleForm"].validateField("provinceId")})),this.$nextTick(function(){t.$refs["ruleForm"].clearValidate()}))}},data:function(){var e=this,t=function(t,a,r){""===e.ruleForm.villageId?r(new Error("请选择完整地区")):r()};return{addressObj:{provinceId:"",provinceName:"",cityId:"",cityName:"",countyId:"",countyName:"",townId:"",townName:"",villageId:"",villageName:""},show:this.value,organOption:[],orgtypeOption:{1:"省卫计委",2:"地市卫计委",3:"县级卫计委",4:"乡镇卫生院",5:"村级卫生室",6:"省外医疗机构",7:"其他医疗机构"},ruleForm:{organizationId:"",name:"",provinceId:"",provinceName:"",cityId:"",cityName:"",countyId:"",countyName:"",townId:"",townName:"",villageId:"",villageName:"",parentOrganizationId:null,parentOrganizationName:"",orgType:"",addressDetail:"",contactName:"",contactPhone:"",orgStatus:1},rules:{name:[{required:!0,message:"请输入机构名称",trigger:"change"}],provinceId:[{required:!0,message:"请选择地址",trigger:"change"},{validator:t,trigger:"change"}],parentOrganizationId:[{required:!0,message:"请选择上级机构",trigger:"change"}],orgType:[{required:!0,message:"请选择机构类别",trigger:"change"}],contactPhone:[{validator:d["a"].validateMobile,trigger:"blur"}]}}},methods:{getOrganDetail:function(){var e=this;this.$http.get("http://bj-ihealthcare.com:52081/phs/service/organization/getById?sysGuid="+this.id).then(function(t){if(200===t.code){var a=t.data;for(var r in e.ruleForm)e.ruleForm[r]=a[r],"parentOrganizationId"===r&&(e.ruleForm[r]="0"!==a[r]?a[r]:null);for(var n in e.addressObj)e.addressObj[n]=e.ruleForm[n]}else e.$message.error(t.msg)}).catch(function(t){e.$message.error(t)})},getParentOrganList:function(){var e=this;this.$http.post("http://bj-ihealthcare.com:52081/phs/service/organization/getOrganization").then(function(t){if(200===t.code){var a=JSON.parse(g()(t.data).replace(/organizationId/g,"id").replace(/name/g,"label").replace(/childrens/g,"children"));e.organOption=a}else e.organOption=[],e.$message.error(t.msg)}).catch(function(t){e.$message.error(t)})},selectParentOrgan:function(e){this.ruleForm.parentOrganizationId=e.id,this.ruleForm.parentOrganizationName=e.label},clearParentOrgan:function(){this.$refs.ruleForm.validateField("parentOrganizationId")},getReportPlace:function(e){var t=JSON.parse(g()(this.addressObj));this.ruleForm=o()(this.ruleForm,t,e),this.$refs.ruleForm.validateField("provinceId")},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=JSON.parse(g()(t.ruleForm)),r={};r=o()({},a),t.id?(r.sysGuid=t.id,t.editOrgan(r)):(delete r.sysGuid,t.addOrgan(r))}})},addOrgan:function(e){var t=this;this.$http.post("http://bj-ihealthcare.com:52081/phs/service/organization/add",e).then(function(e){200===e.code?(t.$message.success("添加成功"),t.show=!1,t.$emit("change",!1),t.$emit("refresh")):t.$message.error(e.msg)}).catch(function(e){t.$message.error(e)})},editOrgan:function(e){var t=this;this.$http.post("http://bj-ihealthcare.com:52081/phs/service/organization/update",e).then(function(e){200===e.code?(t.$message.success("修改成功"),t.show=!1,t.$emit("change",!1),t.$emit("refresh")):t.$message.error(e.msg)}).catch(function(e){t.$message.error(e)})},initForm:function(){var e=this;l()(this.ruleForm).forEach(function(t){return e.ruleForm[t]=""}),l()(this.addressObj).forEach(function(t){return e.addressObj[t]=""}),this.ruleForm.parentOrganizationId=null,this.ruleForm.orgStatus=1},resetForm:function(e){this.show=!1,this.$emit("change",!1)}}}),v=f,b=(a("e629"),a("2877")),y=Object(b["a"])(v,c,u,!1,null,null,null),F=y.exports,O={name:"organs-list",components:{addOrgan:F},data:function(){return{orgtypeOption:{1:"省卫计委",2:"地市卫计委",3:"县级卫计委",4:"乡镇卫生院",5:"村级卫生室",6:"省外医疗机构",7:"其他医疗机构"},searchKey:{organizationIdLike:"",nameLike:"",parentOrganizationNameLike:""},pageNum:1,pageSize:10,totalNum:0,dataList:[],organsDialog:!1,sysGuid:""}},created:function(){this.getDatalist()},methods:{handleView:function(e){this.$router.push({path:"/basicData-manage/organs-manage/organMaintain?id="+e.organizationId})},handleOrgans:function(e){this.organsDialog=!0,this.sysGuid=e||""},querylist:function(){this.pageNum=1,this.getDatalist()},Refreshlist:function(){var e=this;this.pageNum=1,this.pageSize=10,l()(this.searchKey).forEach(function(t){return e.searchKey[t]=""}),this.getDatalist()},changePage:function(e){this.pageNum=e.pageNum,this.pageSize=e.pageSize,this.getDatalist()},getDatalist:function(){var e=this;this.$emit("viewLoad",!0);var t={};t.pageNum=this.pageNum,t.pageSize=this.pageSize,t=o()({},t,this.searchKey),this.$http.post("http://bj-ihealthcare.com:52081/phs/service/organization/getByPage",t).then(function(t){200===t.code?(e.dataList=t.data.list||[],e.totalNum=t.data.total,e.pageNum=t.data.pageNum,e.pageSize=t.data.pageSize):e.$message.error(t.msg),e.$emit("viewLoad",!1)}).catch(function(t){e.$emit("viewLoad",!1),e.$message.error(t)})}}},N=O,z=Object(b["a"])(N,r,n,!1,null,"6b2d368a",null);t["default"]=z.exports},e629:function(e,t,a){"use strict";var r=a("1859"),n=a.n(r);n.a}}]);
//# sourceMappingURL=chunk-2cf956c2.e607d640.js.map