(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f6c02f2"],{"0017":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"table-detail-box permission-box"},[s("div",{staticClass:"title-box"},[s("Breadcrumb",{attrs:{isLevel:2}})],1),s("div",{staticClass:"inner-box"},[s("h3",[e._v("当前角色:"+e._s(e.$route.query.name||e.EMPTYTEXT))]),s("el-checkbox",{staticClass:"check-box",attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}},[e._v("所有菜单")]),s("div",{staticClass:"tree-box"},[s("el-tree",{ref:"tree",attrs:{data:e.menuList,"show-checkbox":"","default-checked-keys":e.selectedMenuIds,"node-key":"id",props:e.props},on:{check:e.handleCheckedChange}})],1),s("div",{staticClass:"btn-box"},[s("el-button",{on:{click:function(t){return e.handleBackList()}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSave()}}},[e._v("确 认")])],1)],1)])},n=[],c=s("75fc"),a=(s("ac6a"),{name:"related-permissions",data:function(){return{props:{children:"children",label:"label"},menuList:[],selectedMenuIds:[],isIndeterminate:!0,allChecked:!1}},created:function(){this.getMenuList()},methods:{getMenuList:function(){var e=this;this.$emit("viewLoad",!0),this.$http.post("http://bj-ihealthcare.com:52081/phs/role/getMenuList",{roleId:this.$route.query.id,projectType:2},!1).then(function(t){if(200===t.code){var s=t.data;e.menuList=s.menuList||[];var i=s.selectedMenuIds||[];e.selectedMenuIds=e.filterSelectArr(e.menuList,i);var n=e.getAllids(e.menuList).length,c=e.selectedMenuIds.length;e.allChecked=c===n,e.isIndeterminate=c>0&&c<n}else e.menuList=[],e.selectedMenuIds=[],e.$message.error(t.msg);e.$emit("viewLoad",!1)}).catch(function(t){e.$emit("viewLoad",!1),e.$message.error(t)})},handleCheckAllChange:function(){this.selectedMenuIds=[],this.allChecked?(this.selectedMenuIds=this.getAllids(this.menuList),this.$refs.tree.setCheckedKeys(this.selectedMenuIds),this.isIndeterminate=!1):(this.selectedMenuIds=[],this.$refs.tree.setCheckedKeys([]),this.isIndeterminate=!0)},filterSelectArr:function(e,t){return e.forEach(function(e){if(-1!==t.indexOf(e.id)&&e.children){var s=e.children.length,i=[];if(e.children.forEach(function(e){i.push.apply(i,Object(c["a"])(t.filter(function(t){return t===e.id})))}),s!==i.length){var n=t.indexOf(e.id);t.splice(n,1)}}}),t},getAllids:function(e){var t=[];return e.forEach(function(e){e.id&&(t.push(e.id),e.children&&e.children.forEach(function(e){t.push(e.id)}))}),t},handleCheckedChange:function(e,t){var s=this.getAllids(this.menuList).length,i=t.checkedKeys.length;this.allChecked=i===s,this.isIndeterminate=i>0&&i<s,this.selectedMenuIds=t.checkedKeys},handleBackList:function(){this.$router.push({path:"/authority-manage/list"})},handleSave:function(){var e=this;if(0===this.selectedMenuIds.length)return this.$notify({title:"提示",message:"至少选择一个权限关联",type:"warning"}),!1;var t=this.$refs.tree.getHalfCheckedKeys(),s=this.$refs.tree.getCheckedKeys(),i=t.concat(s);this.$http.post("http://bj-ihealthcare.com:52081/phs/role/distributeUserAuthority",{roleId:this.$route.query.id,menuIds:i.join(",")},!1).then(function(t){200===t.code?(e.$message.success("保存成功"),e.handleBackList()):e.$message.error(t.msg),e.$emit("viewLoad",!1)}).catch(function(t){e.$emit("viewLoad",!1),e.$message.error(t)})}}}),r=a,l=(s("dec5"),s("2877")),d=Object(l["a"])(r,i,n,!1,null,null,null);t["default"]=d.exports},"054f":function(e,t,s){},dec5:function(e,t,s){"use strict";var i=s("054f"),n=s.n(i);n.a}}]);
//# sourceMappingURL=chunk-5f6c02f2.93cf1bc1.js.map