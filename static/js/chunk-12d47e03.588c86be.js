(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12d47e03"],{"0661":function(e,t,a){},"28c8":function(e,t,a){"use strict";var l=a("993d"),i=a.n(l);i.a},5176:function(e,t,a){e.exports=a("51b6")},9010:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"servicePackage-box"},[a("div",{staticClass:"title-box"},[a("Breadcrumb",[a("span",{attrs:{slot:"custom"},slot:"custom"},[e._v(e._s(this.$route.query.id?"编辑服务包":"新增服务包"))])])],1),a("div",{staticClass:"inner-box"},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"140px"}},[a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"服务包类型：",prop:"packageType"}},[a("el-select",{attrs:{placeholder:"请选择服务包类型"},model:{value:e.ruleForm.packageType,callback:function(t){e.$set(e.ruleForm,"packageType",t)},expression:"ruleForm.packageType"}},e._l(e.packageTypeOption,function(e){return a("el-option",{key:e.value,staticClass:"input-box",attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"服务包名称：",prop:"packageName"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入服务包名称",clearable:"",maxlength:50},model:{value:e.ruleForm.packageName,callback:function(t){e.$set(e.ruleForm,"packageName","string"===typeof t?t.trim():t)},expression:"ruleForm.packageName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{staticClass:"flex",attrs:{label:"服务包年龄限制："}},[a("el-form-item",{attrs:{prop:"limitAgeMin"}},[a("el-input",{staticClass:"small-box",attrs:{placeholder:"最小年龄",clearable:"",maxlength:e.NUMBERLEN},on:{change:function(t){return e.handlervalidate("limitAgeMax")}},model:{value:e.ruleForm.limitAgeMin,callback:function(t){e.$set(e.ruleForm,"limitAgeMin",e._n(t))},expression:"ruleForm.limitAgeMin"}})],1),a("span",{staticClass:"line"},[e._v("-")]),a("el-form-item",{attrs:{prop:"limitAgeMax"}},[a("el-input",{staticClass:"small-box",attrs:{placeholder:"最大年龄",clearable:"",maxlength:e.NUMBERLEN},model:{value:e.ruleForm.limitAgeMax,callback:function(t){e.$set(e.ruleForm,"limitAgeMax",e._n(t))},expression:"ruleForm.limitAgeMax"}})],1),a("span",{staticClass:"label-text"},[e._v("岁")])],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"服务包性别限制：",prop:"limitSexType"}},[a("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.ruleForm.limitSexType,callback:function(t){e.$set(e.ruleForm,"limitSexType",t)},expression:"ruleForm.limitSexType"}},e._l(e.sexTypeOption,function(e){return a("el-option",{key:e.value,staticClass:"input-box",attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"服务时长：",prop:"serviceDays"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入服务时长",clearable:"",maxlength:e.NUMBERLEN},model:{value:e.ruleForm.serviceDays,callback:function(t){e.$set(e.ruleForm,"serviceDays",e._n(t))},expression:"ruleForm.serviceDays"}}),a("span",{staticClass:"label-text"},[e._v("天")])],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"服务包状态：",prop:"packageStatus"}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择状态"},model:{value:e.ruleForm.packageStatus,callback:function(t){e.$set(e.ruleForm,"packageStatus",t)},expression:"ruleForm.packageStatus"}},e._l(e.statusOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),1===e.ruleForm.packageType?a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"服务包价格：",prop:"originalPrice"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入服务包价格",clearable:"",maxlength:e.NUMBERLEN},on:{change:function(t){return e.handlervalidate("discountPrice")}},model:{value:e.ruleForm.originalPrice,callback:function(t){e.$set(e.ruleForm,"originalPrice","string"===typeof t?t.trim():t)},expression:"ruleForm.originalPrice"}})],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"优惠价格：",prop:"discountPrice"}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入优惠价格",clearable:"",maxlength:e.NUMBERLEN},model:{value:e.ruleForm.discountPrice,callback:function(t){e.$set(e.ruleForm,"discountPrice","string"===typeof t?t.trim():t)},expression:"ruleForm.discountPrice"}})],1)],1)],1):e._e(),a("el-form-item",{attrs:{label:"服务包标签：",prop:"labelIdList"}},[a("el-checkbox-group",{model:{value:e.ruleForm.labelIdList,callback:function(t){e.$set(e.ruleForm,"labelIdList",t)},expression:"ruleForm.labelIdList"}},e._l(e.labelListOption,function(t,l){return a("el-checkbox",{key:l,attrs:{label:l}},[e._v(e._s(t))])}),1)],1),a("el-form-item",{attrs:{label:"服务包项目信息：",prop:"itemsJson"}},[a("serviceTable",{ref:"serviceTable",attrs:{dataInfo:e.ruleForm.itemsJson}})],1)],1),a("div",{staticClass:"btn-box"},[a("el-button",{on:{click:function(t){return e.handleBackList()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确 认")])],1)],1)])},i=[],r=a("5176"),s=a.n(r),o=a("f499"),n=a.n(o),p=(a("28a5"),a("c5f6"),a("af75")),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"service-table-box"},[a("el-form",{ref:"ruleForm",attrs:{model:e.model,rules:e.model.rules}},[a("table",{staticClass:"tables-box",attrs:{cellspacing:"0",cellspadding:"0"}},[a("thead",[a("th",[a("span",[e._v("*")]),e._v("项目名称")]),a("th",[e._v("项目详情")]),a("th",[a("span",[e._v("*")]),e._v("履约类型")]),a("th",[a("span",[e._v("*")]),e._v("履约内容")]),a("th",[a("span",[e._v("*")]),e._v("履约格式")]),a("th",[e._v("履约次数")]),a("th",[e._v("状态")]),a("th",[e._v("操作")])]),e._l(e.model.tableList,function(t,l){return a("tbody",{key:l},[l>0?a("tr",[a("td",{staticClass:"title",attrs:{colspan:"8"}},[e._v("项目"+e._s(l+1))])]):e._e(),a("tr",[a("td",[a("el-form-item",{attrs:{prop:"tableList."+l+".itemName",rules:e.model.rules.itemName,"show-message":!1}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入",clearable:""},model:{value:t.itemName,callback:function(a){e.$set(t,"itemName","string"===typeof a?a.trim():a)},expression:"item.itemName"}})],1)],1),a("td",[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入",clearable:""},model:{value:t.itemDetail,callback:function(a){e.$set(t,"itemDetail",e._n(a))},expression:"item.itemDetail"}})],1),a("td",[a("el-form-item",{attrs:{prop:"tableList."+l+".appointType",rules:e.model.rules.appointType,"show-message":!1}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},on:{change:function(a){return e.appointTypeChange(a,t)}},model:{value:t.appointType,callback:function(a){e.$set(t,"appointType",a)},expression:"item.appointType"}},e._l(e.appointTypeOption,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:+t}})}),1)],1)],1),a("td",[Object.keys(e.formatAppointDetail(t.appointType)).length>0?[a("el-form-item",{attrs:{prop:"tableList."+l+".appointDetail",rules:e.model.rules.appointDetail,"show-message":!1}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},model:{value:t.appointDetail,callback:function(a){e.$set(t,"appointDetail",a)},expression:"item.appointDetail"}},e._l(e.formatAppointDetail(t.appointType),function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}),1)],1)]:[e._v(e._s(e.EMPTYTEXT))]],2),a("td",[16!==t.appointType?[a("el-form-item",{attrs:{prop:"tableList."+l+".appointFormat",rules:e.model.rules.appointFormat,"show-message":!1}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},model:{value:t.appointFormat,callback:function(a){e.$set(t,"appointFormat",a)},expression:"item.appointFormat"}},e._l(e.appointFormatOption,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:+t}})}),1)],1)]:[e._v(e._s(e.EMPTYTEXT))]],2),a("td",[16!==t.appointType?[a("el-form-item",{attrs:{prop:"tableList."+l+".appointNum",rules:e.model.rules.appointNum,"show-message":!1}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入数字",clearable:"",maxlength:"4"},model:{value:t.appointNum,callback:function(a){e.$set(t,"appointNum",e._n(a))},expression:"item.appointNum"}})],1)]:[e._v(e._s(e.EMPTYTEXT))]],2),a("td",[16!==t.appointType?[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},model:{value:t.itemStatus,callback:function(a){e.$set(t,"itemStatus",a)},expression:"item.itemStatus"}},e._l(e.statusOption,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:+t}})}),1)]:[e._v(e._s(e.EMPTYTEXT))]],2),a("td",[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteServiceItem(e.model.tableList,l)}}},[e._v("删除")]),16===t.appointType?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.addExecuteItem(t,l)}}},[e._v("添加执行项")]):e._e()],1)]),e._l(t.childrens,function(i,r){return a("tr",{key:r},[a("td",{staticClass:"subTable",attrs:{colspan:"8"}},[a("table",{attrs:{cellspacing:"0",cellspadding:"0"}},[a("tbody",[a("tr",[a("td",{staticClass:"title",attrs:{colspan:"8"}},[e._v("执行项"+e._s(r+1))])]),a("tr",[a("td",[a("el-form-item",{attrs:{prop:"tableList."+l+".childrens."+r+".itemName",rules:e.model.rules.itemName,"show-message":!1}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入",clearable:""},model:{value:i.itemName,callback:function(t){e.$set(i,"itemName","string"===typeof t?t.trim():t)},expression:"it.itemName"}})],1)],1),a("td",[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入",clearable:""},model:{value:i.itemDetail,callback:function(t){e.$set(i,"itemDetail",e._n(t))},expression:"it.itemDetail"}})],1),a("td",[a("el-form-item",{attrs:{prop:"tableList."+l+".childrens."+r+".appointType",rules:e.model.rules.appointType,"show-message":!1}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},model:{value:i.appointType,callback:function(t){e.$set(i,"appointType",t)},expression:"it.appointType"}},e._l(e.formatAppointType(t.appointType),function(e,t){return a("el-option",{key:t,attrs:{label:e,value:+t}})}),1)],1)],1),a("td",[Object.keys(e.formatAppointDetail(i.appointType)).length>0?[a("el-form-item",{attrs:{prop:"tableList."+l+".childrens."+r+".appointDetail",rules:e.model.rules.appointDetail,"show-message":!1}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},model:{value:i.appointDetail,callback:function(t){e.$set(i,"appointDetail",t)},expression:"it.appointDetail"}},e._l(e.formatAppointDetail(i.appointType),function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}),1)],1)]:[e._v(e._s(e.EMPTYTEXT))]],2),a("td",[a("el-form-item",{attrs:{prop:"tableList."+l+".childrens."+r+".appointFormat",rules:e.model.rules.appointFormat,"show-message":!1}},[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},model:{value:i.appointFormat,callback:function(t){e.$set(i,"appointFormat",t)},expression:"it.appointFormat"}},e._l(e.appointFormatOption,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:+t}})}),1)],1)],1),a("td",[a("el-form-item",{attrs:{prop:"tableList."+l+".childrens."+r+".appointNum",rules:e.model.rules.appointNum,"show-message":!1}},[a("el-input",{staticClass:"input-box",attrs:{placeholder:"请输入数字",clearable:"",maxlength:"4"},model:{value:i.appointNum,callback:function(t){e.$set(i,"appointNum",e._n(t))},expression:"it.appointNum"}})],1)],1),a("td",[a("el-select",{staticClass:"input-box",attrs:{placeholder:"请选择",clearable:""},model:{value:i.itemStatus,callback:function(t){e.$set(i,"itemStatus",t)},expression:"it.itemStatus"}},e._l(e.statusOption,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:+t}})}),1)],1),a("td",[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deleteExecuteItem(t.childrens,r)}}},[e._v("删除")])],1)])])])])])})],2)})],2)]),a("div",{staticClass:"add-box"},[a("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus"},on:{click:e.addServiceItem}},[e._v("添加项目")])],1)],1)},u=[],m=a("bd86"),d={name:"service-table",props:{dataInfo:{type:Array,default:function(){return[]}}},data:function(){var e;return{appointTypeOption:{1:"测量类",2:"标记类",4:"公共卫生类",8:"指导类",16:"组合类"},measureOption:{109:"心率",110:"心电",111:"血氧",112:"血压",113:"体温",114:"血糖",115:"尿酸",116:"尿常规",117:"血红蛋白",118:"血脂",119:"BMI"},publicHealthOption:{2001:"健康档案",2002:"健康体检",2003:"预防接种",2004:"儿童",2005:"孕产妇",2006:"老年人",2007:"高血压",2008:"糖尿病",2009:"严重精神障碍",2010:"肺结核",2011:"健康教育",2012:"信息报告",2013:"巡查登记",2014:"传染病报告",2015:"突发公共卫生事件"},appointFormatOption:{1:"年",2:"季度",4:"月",8:"日"},statusOption:{1:"是",2:"否"},model:{rules:(e={itemName:[{required:!0,message:"请输入项目名称",trigger:"change"}],appointType:[{required:!0,message:"请选择",trigger:"change"}],appointDetail:[{required:!0,message:"请选择",trigger:"change"}]},Object(m["a"])(e,"appointDetail",[{required:!0,message:"请选择",trigger:"change"}]),Object(m["a"])(e,"appointFormat",[{required:!0,message:"请选择",trigger:"change"}]),Object(m["a"])(e,"appointNum",[{validator:p["a"].validateInteger,trigger:"change"}]),e),tableList:this.dataInfo}}},watch:{dataInfo:function(e,t){this.model.tableList=e}},created:function(){},methods:{formatAppointDetail:function(e){var t={};return t=1==e?s()({},this.measureOption):4==e?s()({},this.publicHealthOption):{},t},formatAppointType:function(e){var t={};if(16==e){var a=JSON.parse(n()(this.appointTypeOption));delete a[e],t=s()({},a)}else t=this.appointTypeOption;return t},addServiceItem:function(){var e={itemName:"",itemDetail:"",appointType:"",appointFormat:"",appointNum:"",appointDetail:"",itemStatus:1,childrens:[]};this.dataInfo.push(e)},addExecuteItem:function(e){var t={itemName:"",itemDetail:"",appointType:"",appointFormat:"",appointNum:"",appointDetail:"",itemStatus:1};e.childrens.push(t)},deleteServiceItem:function(e,t){e[0].childrens.length>0?this.$confirm("确定后，子项也将一并删除","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消",customClass:"infoMessage",center:!0}).then(function(){e.splice(t,1)}):e.splice(t,1)},deleteExecuteItem:function(e,t){e.splice(t,1)},appointTypeChange:function(e,t){t.appointDetail="",t.childrens.length>0&&16!=e&&this.$confirm("修改后，子项也将一并删除","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消",customClass:"infoMessage",center:!0}).then(function(){t.childrens=[]}).catch(function(){t.appointType=16})}}},b=d,g=(a("28c8"),a("2877")),h=Object(g["a"])(b,c,u,!1,null,null,null),f=h.exports,v={name:"servicePackage-add",components:{serviceTable:f},data:function(){var e=this,t=function(t,a,l){""!==a||0===a?e.ruleForm.limitAgeMin?a<e.ruleForm.limitAgeMin?l(new Error("不能小于最小年龄")):l():l(new Error("请输入最小年龄")):l()},a=function(t,a,l){a&&(e.ruleForm.originalPrice?Number(a)>Number(e.ruleForm.originalPrice)?l(new Error("不能大于服务价格")):l():l(new Error("请输入服务包价格")))};return{packageTypeOption:[{value:1,label:"付费"},{value:2,label:"免费"}],sexTypeOption:[{value:0,label:"不限制"},{value:1,label:"男"},{value:2,label:"女"}],statusOption:[{value:1,label:"已启用"},{value:2,label:"已禁用"}],labelListOption:{},ruleForm:{packageType:2,packageName:"",limitAgeMin:"",limitAgeMax:"",limitSexType:0,serviceDays:"",packageStatus:1,originalPrice:"",discountPrice:"",labelIdList:[],labelNameList:"",itemsJson:[]},rules:{packageName:[{required:!0,message:"服务包名称不能为空",trigger:"change"}],limitAgeMin:[{type:"number",validator:p["a"].validateInteger,trigger:"change"}],limitAgeMax:[{type:"number",validator:p["a"].validateInteger,trigger:"change"},{validator:t,trigger:"change"}],serviceDays:[{type:"number",required:!0,message:"服务时长不能为空",trigger:"change"},{validator:p["a"].validateInteger,trigger:"change"}],originalPrice:[{type:"number",validator:p["a"].validateNumber,trigger:"change"}],discountPrice:[{type:"number",validator:p["a"].validateNumber,trigger:"change"},{validator:a,trigger:"change"}],labelIdList:[{type:"array",required:!0,message:"请选择服务标签",trigger:"change"}],itemsJson:[{type:"array",required:!0,message:"请选择服务项目",trigger:"change"}]}}},created:function(){this.getLabelist(),this.$route.query.id&&this.getservicePackageDetail()},methods:{handlervalidate:function(e){this.$refs["ruleForm"].validateField(e)},getLabelist:function(){var e=this;this.$emit("viewLoad",!0),this.$http.post("http://bj-ihealthcare.com:52081/phs/family/label/getBy").then(function(t){if(200===t.code){var a=t.data||[];for(var l in e.labelListOption={},a)e.labelListOption[a[l].labelId]=a[l].labelName}else e.$message.error(t.msg);e.$emit("viewLoad",!1)}).catch(function(t){e.$emit("viewLoad",!1),e.$message.error(t)})},getservicePackageDetail:function(){var e=this;this.$http.get("http://bj-ihealthcare.com:52081/phs/family/servicePackage/getDtoByPackageId",{packageId:this.$route.query.id}).then(function(t){if(200===t.code){var a=t.data;for(var l in e.ruleForm.packageId=a.packageId,e.ruleForm)e.ruleForm[l]=a[l];e.ruleForm.itemsJson=a.itemsJson?JSON.parse(a.itemsJson):[],e.ruleForm.labelIdList=a.labelIdList.split(","),e.$nextTick(function(){e.$refs["ruleForm"].clearValidate()})}else e.$message.error(t.msg)}).catch(function(t){e.$message.error(t)})},submitForm:function(e){var t=this;this.$refs["ruleForm"].validate(function(e){e&&t.$refs.serviceTable.$children[0].validate(function(e){var a={},l=JSON.parse(n()(t.ruleForm));a.itemsJson=n()(l.itemsJson),a.labelIdList=l.labelIdList.join(","),a.labelNameList=l.labelIdList.map(function(e){return t.labelListOption[e]}).join(","),a=s()({},t.ruleForm,a),e&&(t.$route.query.id?t.editServePackage(a):t.addServePackage(a))})})},addServePackage:function(e){var t=this;this.$http.post("http://bj-ihealthcare.com:52081/phs/family/servicePackage/insert",e).then(function(e){200===e.code?(t.$message.success("添加成功"),t.handleBackList()):t.$message.error(e.msg)}).catch(function(e){t.$message.error(e)})},editServePackage:function(e){var t=this;this.$http.post("http://bj-ihealthcare.com:52081/phs/family/servicePackage/update",e).then(function(e){200===e.code?(t.$message.success("修改成功"),t.handleBackList()):t.$message.error(e.msg)}).catch(function(e){t.$message.error(e)})},handleBackList:function(){this.$router.push({path:"/system-manage/servicePackage-manage/list"})}}},y=v,x=(a("d4ea"),Object(g["a"])(y,l,i,!1,null,null,null));t["default"]=x.exports},"993d":function(e,t,a){},d4ea:function(e,t,a){"use strict";var l=a("0661"),i=a.n(l);i.a}}]);
//# sourceMappingURL=chunk-12d47e03.588c86be.js.map