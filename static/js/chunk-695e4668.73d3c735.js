(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-695e4668"],{"09a8":function(e,t,o){"use strict";var a=o("b5ce"),i=o.n(a);i.a},"2e6b":function(e,t,o){},5176:function(e,t,o){e.exports=o("51b6")},"63dd":function(e,t,o){"use strict";var a=o("2e6b"),i=o.n(a);i.a},aac9:function(e,t,o){e.exports=o.p+"static/img/login-main.2199bb89.png"},b5ce:function(e,t,o){},dc3f:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"cc-login"},[o("div",{staticClass:"cc-login-wrapper"},[e._m(0),o("div",{staticClass:"cc-login-right"},[o("div",{staticClass:"cc-login-form",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handlerLogin(t)}}},[e._m(1),o("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.rules}},[o("el-form-item",{attrs:{prop:"accountNo"}},[o("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},on:{blur:function(t){return e.getOrganizationList()}},model:{value:e.loginForm.accountNo,callback:function(t){e.$set(e.loginForm,"accountNo","string"===typeof t?t.trim():t)},expression:"loginForm.accountNo"}},[o("cc-svg-icon",{staticClass:"icon",attrs:{slot:"prefix","icon-class":"user"},slot:"prefix"})],1)],1),o("el-form-item",{attrs:{prop:"passwords"}},[o("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:""},model:{value:e.loginForm.passwords,callback:function(t){e.$set(e.loginForm,"passwords","string"===typeof t?t.trim():t)},expression:"loginForm.passwords"}},[o("cc-svg-icon",{staticClass:"icon",attrs:{slot:"prefix","icon-class":"lock"},slot:"prefix"})],1)],1),o("el-form-item",{attrs:{prop:"organizationId"}},[o("el-select",{attrs:{placeholder:"请选择机构",clearable:""},model:{value:e.loginForm.organizationId,callback:function(t){e.$set(e.loginForm,"organizationId",t)},expression:"loginForm.organizationId"}},[e._l(e.organizationOption,function(e){return o("el-option",{key:e.organizationId,attrs:{label:e.organizationName,value:e.organizationId}})}),o("cc-svg-icon",{staticClass:"icon",attrs:{slot:"prefix","icon-class":"build"},slot:"prefix"})],2)],1),e.codeStatus?o("el-form-item",{staticClass:"code-box",attrs:{prop:"validateCode"}},[o("el-input",{staticClass:"small-box",attrs:{clearable:"",placeholder:"请输入验证码"},model:{value:e.loginForm.validateCode,callback:function(t){e.$set(e.loginForm,"validateCode",t)},expression:"loginForm.validateCode"}},[o("cc-svg-icon",{staticClass:"icon",attrs:{slot:"prefix","icon-class":"code"},slot:"prefix"})],1),o("img",{attrs:{src:"data:image/jpeg;base64,"+e.code,alt:""},on:{click:e.getVerificationCode}})],1):e._e(),o("el-form-item",[o("div",{staticClass:"handle-box"},[o("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住密码")]),o("router-link",{staticClass:"forget",attrs:{to:"/forget-pass"}},[e._v("忘记密码?")])],1)]),o("el-form-item",[o("el-button",{staticClass:"login-btn",attrs:{type:"primary",size:"small"},on:{click:e.handlerLogin}},[e._v("登录")])],1)],1)],1)])])])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cc-login-left"},[a("div",{staticClass:"logo-box"},[a("img",{attrs:{src:o("9d64"),alt:""}})]),a("img",{attrs:{src:o("aac9"),alt:""}})])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"title"},[o("h1",[e._v("家庭医生服务平台")])])}],r=(o("96cf"),o("3b8d")),n=o("f499"),s=o.n(n),c=o("5176"),l=o.n(c),g=(o("c5f6"),o("a4bb")),d=o.n(g),m=o("8e17"),u=o("af75"),p={name:"cc-login",data:function(){return{utils:m["a"],organizationOption:[],checked:!1,wrongTimes:0,key:"6p2wf0wi9hhc2a7h",codeStatus:!1,code:"",loginForm:{accountNo:"",passwords:"",organizationId:"",keyId:"",validateCode:""},rules:{accountNo:[{required:!0,message:"用户名不能为空",trigger:"blur"},{validator:u["a"].validateEAN,trigger:"blur"}],passwords:[{required:!0,message:"密码不能为空",trigger:"blur"}],organizationId:[{required:!0,message:"请选择机构",trigger:"change"}],validateCode:[{required:!0,message:"请输入验证码",trigger:"change"}]}}},created:function(){if(this.getWrongTime(),this.checked=!!localStorage.getItem("rememberChecked")&&JSON.parse(localStorage.getItem("rememberChecked")),!0===this.checked){var e=localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):{};d()(e).length>0&&(e.passwords=m["a"].decrypt(e.passwords,this.key)),this.loginForm=e,this.getOrganizationList()}},methods:{getOrganizationList:function(){var e=this;this.loginForm.accountNo&&this.$http.noTokenPost("http://bj-ihealthcare.com:52081/phs/login/getUserOrganizationList",{accountNo:this.loginForm.accountNo}).then(function(t){200===t.code?e.organizationOption=t.data.organizationList:(e.organizationOption=[],e.$message.error("该用户无对应机构")),e.loginForm.organizationId=e.organizationOption.length>0?e.organizationOption[0].organizationId:""}).catch(function(t){e.organizationOption=[],e.$message.error(t)})},getVerificationCode:function(){var e=this;this.$http.post("http://bj-ihealthcare.com:52081/phs/login/getValidateCode").then(function(t){200===t.code&&(e.loginForm.keyId=t.data.keyId,e.code=t.data.validateCode)}).catch(function(t){e.$message.error(t)})},getWrongTime:function(){var e=localStorage.getItem("wrongTimes");e?(this.wrongTimes=Number(e),this.wrongTimes>=3?(this.codeStatus=!0,this.getVerificationCode()):this.codeStatus=!1):this.wrongTimes=0},handlerLogin:function(){var e=this;this.$refs.loginForm.validate(function(t){if(t){if(!0===e.checked){localStorage.setItem("rememberChecked",e.checked);var o={};o.passwords=m["a"].encrypt(e.loginForm.passwords,e.key),o.validateCode="",o=l()({},e.loginForm,o),localStorage.setItem("userInfo",s()(o))}else localStorage.removeItem("rememberChecked"),localStorage.removeItem("userInfo");var a={projectType:2};a=l()({},e.loginForm,a),e.$store.dispatch("login",a).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(o){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(200!==o.code){t.next=8;break}return e.wrongTimes=0,localStorage.removeItem("wrongTimes"),e.$message.success("登录成功"),t.next=6,e.$store.dispatch("getUserInfo").then(function(e){window.location.reload()});case 6:t.next=12;break;case 8:e.$message.error(o.msg),e.getWrongTime(),e.wrongTimes++,localStorage.setItem("wrongTimes",e.wrongTimes);case 12:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}})}}},f=p,h=(o("09a8"),o("63dd"),o("2877")),v=Object(h["a"])(f,a,i,!1,null,"26d518ec",null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-695e4668.73d3c735.js.map